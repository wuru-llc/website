---
import { Image } from "astro:assets";
import BallLoop from "../../src/assets/images/ball-looped.png";
import Footer from "../components/Footer/Footer.astro";
import FloatingHeader from "../components/Header/FloatingHeader.astro";
import Header from "../components/Header/Header.astro";
import Layout from "../layouts/Base.astro";

import BrainIcon from "../assets/images/brain.svg";
import TimeIcon from "../assets/images/time.svg";
import VitalIcon from "../assets/images/vital.svg";
import ImageParallax from "../components/ImageParallax.astro";
import image1 from "../assets/images/1p.webp";
import image2 from "../assets/images/2p.webp";
import image3 from "../assets/images/3p.webp";
import chat from "../assets/images/chat.svg";
import surgeon from "../assets/images/surgeon.svg";
import infusion from "../assets/images/infusion.svg";

import StepInfo from "../components/Product/StepInfo.astro";
import AnimatedItem from "../components/AnimatedItem.astro";
import ScrollDown from "../components/Hero/ScrollDown.astro";

const solutionInfo = [
  {
    title: "Wúru para Quirófanos",
    description:
      "Optimice la programación, el flujo de pacientes y la utilización de recursos en entornos quirúrgicos con nuestra solución especializada.",
    items: [
      "Programación inteligente que reduce tiempos de espera y maximiza la utilización de quirófanos",
      "Coordinación en tiempo real entre equipos quirúrgicos, anestesia y personal de apoyo",
      "Análisis predictivo para anticipar necesidades de recursos y prevenir cuellos de botella",
    ],
  },
  {
    title: "Wúru para Centros de Infusión",
    description:
      "Mejore la eficiencia y la experiencia del paciente en centros de infusión con nuestra solución adaptada a sus necesidades específicas.",
    items: [
      "Gestión optimizada de citas que reduce tiempos de espera y mejora la utilización de sillones",
      "Seguimiento automatizado de medicamentos y suministros para prevenir escasez",
      "Monitoreo en tiempo real de pacientes para mejorar la seguridad y la calidad de atención",
      "Prevención de errores",
    ],
  },
  {
    title: "Agente de WhatsApp",
    description: "Simplifique la comunicación y automatice tareas rutinarias con nuestro asistente virtual integrado con WhatsApp, disponible 24/7.",
    itemsTitles: ["Reserva de espacios", "Solicitud de informes", "Confirmaciones automáticas", "Asistente inteligente"],
    items: [
      "Los cirujanos pueden consultar disponibilidad y reservar quirófanos directamente desde WhatsApp con confirmación instantánea.",
      "Acceso rápido a reportes operativos, estadísticas y documentación clínica mediante comandos sencillos.",
      "Envío de recordatorios, confirmaciones y notificaciones de cambios en la programación quirúrgica.",
      "Respuestas contextuales basadas en IA que mejoran con cada interacción, proporcionando información precisa y relevante.",
    ],
  },
];
---

<script is:inline>
  document.addEventListener("DOMContentLoaded", () => {
    const links = document.querySelectorAll(".solutions-scroll-link");
    const sections = document.querySelectorAll("section");
    const buttonPill = document.querySelector(".button-pill");

    let isScrollingFromClick = false;
    let observer;

    function movePillTo(link) {
      const newLeft = link.offsetLeft;
      buttonPill.style.left = `${newLeft}px`;

      if (!buttonPill.classList.contains("visible")) {
        buttonPill.classList.add("visible");
      }
    }

    function setupObserver() {
      const observerOptions = {
        root: null,
        rootMargin: "0px",
        threshold: 0.8,
      };

      observer = new IntersectionObserver((entries) => {
        if (isScrollingFromClick) return;

        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            const id = entry.target.id;

            if (id === "solutions-hero") {
              buttonPill.classList.remove("visible");
            } else {
              const activeLink = document.querySelector(`.solutions-scroll-link[data-target="${id}"]`);
              if (activeLink) {
                movePillTo(activeLink);
              }
            }
          }
        });
      }, observerOptions);

      sections.forEach((section) => observer.observe(section));
    }

    links.forEach((link) => {
      link.addEventListener("click", (e) => {
        e.preventDefault();
        isScrollingFromClick = true;
        movePillTo(link);

        // Navega y centra la sección en pantalla
        const targetId = link.getAttribute("data-target");
        const targetSection = document.getElementById(targetId);
        if (targetSection) {
          targetSection.scrollIntoView({ behavior: "smooth", block: "center" });
        }

        setTimeout(() => {
          isScrollingFromClick = false;
        }, 700);
      });
    });

    setupObserver();
  });
</script>

<Layout title="Wúru | Productos">
  <Header />
  <FloatingHeader />

  <div class="floating-solutions-nav-container">
    <span class="solutions-nav">
      <a href="#qx-section" class="solutions-scroll-link" data-target="qx-section">QUIRÓFANOS</a>
      <a href="#infusion-section" class="solutions-scroll-link" data-target="infusion-section">CENTROS DE INFUSIÓN</a>
      <a href="#assistant-section" class="solutions-scroll-link" data-target="assistant-section">ASISTENTE VIRTUAL</a>

      <div class="button-pill">
        <span class="back-color"></span>
      </div>
    </span>
  </div>
  <section class="solutions-hero" id="solutions-hero">
    <div class="top">
      <div class="left-side">
        <h1>Soluciones de <span class="IA">IA</span></h1>
        <h1 style="animation-delay: 0.1s;">para el sector de la salud</h1>
        <div class="line" style="margin-top: 32px;"></div>

        <h3 style=" margin-top: 32px; animation-delay: 0.3s;">Transformando la atención médica</h3>
        <h3 style="animation-delay: 0.4s;">con flujos de trabajo inteligentes y automatizados</h3>
      </div>
      <div class="right-side">
        <Image src={BallLoop} alt="ball-loop" height={300} class="ball-loop" loading={"eager"} />
      </div>
      <span class="scroll-to-btn">
        <ScrollDown scrollDownTo="#hero-bottom" />
      </span>
    </div>
    <AnimatedItem animation="translateY(10px)" showPoint={0.7}>
      <div class="bottom" id="hero-bottom">
        <div class="text-container">
          <h2>
            Nuestra <strong class="highlight">plataforma</strong> impulsada por <strong class="highlight"
              ><span style="color: #ec5a3d ;">IA </span>automatiza tareas repetitivas</strong
            >,
            <span style="color: #ec5a3d ;">optimiza flujos de trabajo y mejora la experiencia </span>tanto para profesionales de la salud como para
            pacientes.
          </h2>
        </div>
        <div class="card-container">
          <AnimatedItem animation="translateY(20px)" showPoint={0.5} delay="0.5s">
            <div class="card">
              <Image src={BrainIcon} alt="brain" height={40} loading={"eager"} />
              <span class="card-text">
                <h3>Inteligencia Artificial Avanzada</h3>
                <p>Algoritmos de aprendizaje automático que se adaptan a las necesidades específicas de cada centro médico.</p>
              </span>
            </div>
          </AnimatedItem>
          <AnimatedItem animation="translateY(20px)" showPoint={0.5} delay="0.25s">
            <div class="card">
              <Image src={TimeIcon} alt="brain" height={40} loading={"eager"} />
              <span class="card-text">
                <h3>Ahorro de Tiempo</h3>
                <p>Reducción de hasta un 40% en tareas administrativas, permitiendo más tiempo para la atención al paciente.</p>
              </span>
            </div>
          </AnimatedItem>
          <AnimatedItem animation="translateY(20px)" showPoint={0.5} delay="0.7s">
            <div class="card">
              <Image src={VitalIcon} alt="brain" height={40} loading={"eager"} />
              <span class="card-text">
                <h3>Mejora de Resultados</h3>
                <p>Optimización de procesos que resulta en mejores resultados clínicos y mayor satisfacción del paciente.</p>
              </span>
            </div>
          </AnimatedItem>
        </div>
      </div>
    </AnimatedItem>
  </section>

  <section class="product-big-features">
    <div class="product-descrtiption" id="qx-section">
      <div class="img-container">
        <ImageParallax>
          <Image src={image1} alt="Parallax image 1" width={1200} loading={"lazy"} />
        </ImageParallax>
      </div>
      <StepInfo title={solutionInfo[0].title} description={solutionInfo[0].description} items={solutionInfo[0].items}>
        <div class="icon-container">
          <Image src={surgeon} alt="brain" height={24} loading={"eager"} />
          Quirófanos
        </div>
      </StepInfo>
    </div>

    <div class="product-descrtiption" id="infusion-section">
      <StepInfo invert={true} title={solutionInfo[1].title} description={solutionInfo[1].description} items={solutionInfo[1].items}>
        <div class="icon-container">
          <Image src={infusion} alt="brain" height={24} loading={"eager"} />
          Centros de Infusión
        </div></StepInfo
      >
      <div class="img-container">
        <ImageParallax>
          <Image src={image2} alt="Parallax image 2" width={1200} loading={"lazy"} />
        </ImageParallax>
      </div>
    </div>

    <div class="product-descrtiption" id="assistant-section">
      <div class="img-container">
        <ImageParallax>
          <Image src={image3} alt="Parallax image 3" width={1200} loading={"lazy"} />
        </ImageParallax>
      </div>
      <StepInfo title={solutionInfo[2].title} description={solutionInfo[2].description} items={solutionInfo[2].items}>
        <div class="icon-container">
          <Image src={chat} alt="brain" height={24} loading={"eager"} />
          Asistente Virtual
        </div>
      </StepInfo>
    </div>
  </section>

  <div class="text-banner-container">
    <h1><span style="opacity: 0.5">Transformando los </span>flujos de trabajo<span style="opacity: 0.5"> en salud</span></h1>
    <div class="line"></div>
    <p class="bottom-text">
      Contáctanos para una demostración personalizada y descubre cómo nuestras soluciones pueden mejorar la eficiencia y la calidad de atención en tu
      institución.
    </p>
  </div>
  <Footer />
</Layout>

<style lang="scss">
  @keyframes text-in-slide {
    0% {
      opacity: 0;
      transform: translateX(-10px);
    }
    100% {
      opacity: 1;
      transform: translateX(0px);
    }
  }
  h1,
  h2,
  h3,
  p,
  ul,
  li {
    margin: 0;
  }
  html {
    scroll-behavior: smooth;
    position: relative;
  }

  body {
    position: relative;
  }

  .line {
    height: 0.5px;
    width: 70%;
    background-color: #ec5a3d;
    border-radius: 0.5px;
    opacity: 0.7;
    animation-delay: 0.4s;
    filter: drop-shadow(0 2px 5px rgba(255, 0, 0, 0.8));
  }

  .floating-solutions-nav-container {
    position: fixed;
    left: 0;
    right: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    bottom: 48px;
    z-index: 99;
    .solutions-nav {
      position: relative;
      height: 64px;
      border-radius: 32px;
      background-image: linear-gradient(45deg, #110e10a0, #1a1117a0, #21121da0, #281319a0, #301a14a0);
      border: solid 0.25px #7d170363;
      display: flex;
      align-items: center;
      color: #f1f1f1;
      font-size: 14px;
      font-weight: 400px;
      letter-spacing: 1px;
      box-shadow:
        5px 5px 20px 0px #000000,
        -5px -5px 20px 0px #400000;
      backdrop-filter: blur(5px);

      &:hover {
        opacity: 1;
        border: solid 0.25px #7d1703bf;
      }

      a {
        text-decoration: none;
        color: unset;
      }
      .solutions-scroll-link {
        width: 250px;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1;
      }
      .button-pill {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100%;
        position: absolute;
        width: 250px;
        left: 0%;
        padding: 4px;
        z-index: 0;
        transition: all 0.2s ease-out;
        opacity: 0; // ← inicia invisible

        &.visible {
          opacity: 1;
        }

        .back-color {
          height: 100%;
          width: 100%;
          background-color: rgba(241, 241, 241, 0.1098039216);
          backdrop-filter: blur(2px);
          border: 0.5px solid rgba(241, 241, 241, 0.3411764706);
          border-radius: 32px;
        }
      }
    }
  }

  .solutions-hero {
    display: flex;
    align-items: center;
    justify-content: center;
    color: #f1f1f1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: space-between;
    padding-top: 15vh;

    .top {
      max-height: 1000px;
      min-height: 500px;
      height: 60vh;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 48px;
      position: relative;
      .left-side {
        display: flex;
        align-items: flex-end;
        justify-content: flex-end;
        flex-direction: column;
        text-align: right;
        h1 {
          font-size: 40px;
          color: #f1f1f1;
          font-weight: 900;
          letter-spacing: 1px;
          text-transform: uppercase;
          animation: text-in-slide 0.2s ease-out forwards;
          opacity: 0;
          &:first-child {
            font-size: 48px;
          }

          .IA {
            font-size: 64px;
            color: #ec5a3d;
            filter: drop-shadow(0 2px 5px rgba(255, 0, 0, 0.5));
          }
        }
        .line {
          height: 0.5px;
          width: 50%;
          background-color: #ec5a3d8a;
          border-radius: 0.5px;
          margin-top: 16px;
          opacity: 0.7;
          filter: drop-shadow(0 2px 5px rgba(255, 0, 0, 0.5));
        }
        h3 {
          margin: 0;
          font-size: 24px;
          width: 600px;
          line-height: 32px;
          color: #ec5a3d;
          font-weight: 300;
          animation: text-in-slide 0.2s ease-out forwards;
          filter: drop-shadow(0 2px 5px rgba(255, 0, 0, 0.5));
          opacity: 0;
        }
      }
      .scroll-to-btn {
        position: absolute;
        bottom: 5vh;
      }
      .right-side {
        img {
          filter: contrast(1.05) brightness(1.1) saturate(1.05);
        }
      }
    }
    .bottom {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      width: 100%;
      gap: 48px;
      padding: 48px;

      .text-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        width: 80%;

        h2 {
          font-size: 28px;
          line-height: 1.5;
          text-align: center;
          font-weight: 400;
          color: #f1f1f1ba;
          .highlight {
            color: #f1f1f1;
          }
        }
      }
      .card-container {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        align-items: center;
        justify-content: center;
        gap: 24px;
        width: 100%;

        .card {
          background-color: rgba(255, 95, 63, 0.052);
          height: 200px;
          padding: 24px;
          width: 100%;
          border-radius: 10px;
          border: solid 0.5px rgba(109, 30, 12, 0.248);
          background-image: linear-gradient(
            to right top,
            rgba(205, 0, 90, 0.1),
            rgba(209, 27, 100, 0.1),
            rgba(213, 43, 110, 0.1),
            rgba(217, 55, 119, 0.1),
            rgba(220, 66, 129, 0.1),
            rgba(216, 65, 127, 0.1),
            rgba(211, 64, 124, 0.1),
            rgba(207, 63, 122, 0.1),
            rgba(194, 51, 108, 0.1),
            rgba(181, 37, 94, 0.1),
            rgba(168, 22, 81, 0.1),
            rgba(155, 0, 68, 0.1)
          );
          backdrop-filter: blur(2px);
          box-shadow:
            2.8px 2.4px 1.2px rgba(0, 0, 0, 0.021),
            6.2px 5.2px 2.7px rgba(0, 0, 0, 0.031),
            10.4px 8.7px 4.6px rgba(0, 0, 0, 0.038),
            15.7px 13.1px 6.9px rgba(0, 0, 0, 0.044),
            22.7px 18.9px 10px rgba(0, 0, 0, 0.05),
            32.1px 26.8px 14.2px rgba(0, 0, 0, 0.056),
            45.5px 37.9px 20.1px rgba(0, 0, 0, 0.062),
            66.1px 55.1px 29.2px rgba(0, 0, 0, 0.069),
            101.8px 84.9px 45px rgba(0, 0, 0, 0.079),
            181px 151px 80px rgba(0, 0, 0, 0.1);

          display: flex;
          gap: 16px;
          img {
            opacity: 0.9;
            filter: drop-shadow(0 2px 5px rgba(255, 0, 0, 0.5));
          }
          .card-text {
            margin-top: 8px;
            display: flex;
            flex-direction: column;
            gap: 8px;
            h3 {
              font-size: 20px;
              font-weight: 600;
              color: #f1f1f1;
              margin-bottom: 4px;
            }
            p {
              font-size: 14px;
              color: #f1f1f1;
              opacity: 0.8;
              line-height: 1.5;
              text-wrap: pretty;
            }
          }
        }
      }
    }
  }

  .product-big-features {
    margin: 48px;
    .product-descrtiption {
      display: grid;
      grid-template-columns: 1fr 1fr;
      align-items: center;
      border-radius: 10px;
      overflow: hidden;
      background-color: #f1f1f11c;
      backdrop-filter: blur(5px);
      border: 0.5px solid #f1f1f157;
      margin-top: 64px;
      margin-bottom: 64px;
      box-shadow:
        2.8px 2.4px 1.2px rgba(0, 0, 0, 0.021),
        6.2px 5.2px 2.7px rgba(0, 0, 0, 0.031),
        10.4px 8.7px 4.6px rgba(0, 0, 0, 0.038),
        15.7px 13.1px 6.9px rgba(0, 0, 0, 0.044),
        22.7px 18.9px 10px rgba(0, 0, 0, 0.05),
        32.1px 26.8px 14.2px rgba(0, 0, 0, 0.056),
        45.5px 37.9px 20.1px rgba(0, 0, 0, 0.062),
        66.1px 55.1px 29.2px rgba(0, 0, 0, 0.069),
        101.8px 84.9px 45px rgba(0, 0, 0, 0.079),
        181px 151px 80px rgba(0, 0, 0, 0.1);
      .img-container {
        display: flex;
        align-items: center;
        justify-content: center;
        color: #f1f1f1;
        overflow: hidden;
        position: relative;
        height: 100%;
        aspect-ratio: 1;
        img {
          width: 100%;
          height: 100%;
          object-fit: cover;
        }
      }
    }
  }

  @keyframes parallax {
    from {
      opacity: 0;
      transform: translateY(400px);
    }
    to {
      opacity: 1;
      transform: translateY(-100px);
    }
  }

  @media only screen and (max-width: 1024px) {
    .solutions-hero {
      .top {
        height: 70vh;
        flex-direction: column-reverse;
        .left-side {
          align-items: center;
          justify-content: center;
          h3 {
            text-align: center;
            width: 100%;
          }
        }
        .scroll-to-btn {
          bottom: 0px !important;
        }
      }
      .card-container {
        .card {
          flex-direction: column;
          height: 300px !important;
        }
      }
    }
    .product-big-features {
      margin: 24px;
    }
    .text-banner-container {
      .bottom-text {
        font-size: 24px !important;
      }
    }
    :global(.step-info-container) {
      max-width: 90% !important;
    }
  }

  @media only screen and (max-width: 768px) {
    .product-feature {
      .content {
        display: unset !important;
        grid-template-columns: unset !important;

        .left-side {
          width: 100%;
          display: flex !important;
          flex-direction: column !important;
          overflow: hidden;

          .mobile {
            display: block !important;
          }
        }
        .right-side {
          display: none;
        }
      }
    }
  }

  .text-banner-container {
    width: 100%;
    height: 50vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    color: #f1f1f1;
    gap: 24px;
    h1 {
      text-align: center;
      text-wrap: pretty;
      font-size: 54px;
      width: 80%;
    }
    .bottom-text {
      font-size: 32px;
      text-align: center;
      text-wrap: pretty;
      width: 60%;
      line-height: 40px;
      color: #ec5a3d;
      font-weight: 300;
      animation: text-in-slide 0.2s ease-out forwards;
      filter: drop-shadow(0 2px 5px rgba(255, 0, 0, 0.5));
      justify-content: center;
    }
  }
  :global(.icon-container) {
    padding: 0px 16px;
    background-color: #ec5a3d7b;
    height: 32px;
    border-radius: 16px;
    border: solid 0.5px #ec5a3d;
    color: #f6c1b7;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    font-weight: 600;
  }
</style>
